{% extends "base.html" %}

{% block title %}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card shadow">
            <div class="card-header bg-primary text-white">
                <h4 class="mb-0">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è</h4>
            </div>
            <div class="card-body">
                {% if error %}
                <div class="alert alert-danger">{{ error }}</div>
                {% endif %}
                
                <div class="row">
                    <div class="col-md-6">
                        <h5>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h5>

                        <form method="post" action="/profile/edit">
                            <div class="mb-3">
                                <label for="username" class="form-label">–ò–º—è/–Ω–∏–∫–Ω–µ–π–º</label>
                                <input type="text" class="form-control" id="username" name="username"
                                       value="{{ user.username }}" required>
                            </div>

                            <div class="mb-3">
                                <label for="specialization" class="form-label">–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è</label>
                                <select class="form-select" id="specialization" name="specialization" required>
                                    <option value="Backend" {% if user.specialization == 'Backend' %}selected{% endif %}>Backend</option>
                                    <option value="Frontend" {% if user.specialization == 'Frontend' %}selected{% endif %}>Frontend</option>
                                    <option value="Fullstack" {% if user.specialization == 'Fullstack' %}selected{% endif %}>Fullstack</option>
                                    <option value="Data Science" {% if user.specialization == 'Data Science' %}selected{% endif %}>Data Science</option>
                                    <option value="DevOps" {% if user.specialization == 'DevOps' %}selected{% endif %}>DevOps</option>
                                    <option value="Mobile" {% if user.specialization == 'Mobile' %}selected{% endif %}>Mobile</option>
                                </select>
                            </div>

                            <div class="mb-3">
                                <label for="experience" class="form-label">–£—Ä–æ–≤–µ–Ω—å –æ–ø—ã—Ç–∞</label>
                                <select class="form-select" id="experience" name="experience" required>
                                    <option value="Junior" {% if user.experience == 'Junior' %}selected{% endif %}>Junior</option>
                                    <option value="Middle" {% if user.experience == 'Middle' %}selected{% endif %}>Middle</option>
                                    <option value="Senior" {% if user.experience == 'Senior' %}selected{% endif %}>Senior</option>
                                </select>
                            </div>

                            <div class="mb-3">
                                <label for="bio" class="form-label">–û —Å–µ–±–µ</label>
                                <textarea class="form-control" id="bio" name="bio" rows="4">{{ user.bio or '' }}</textarea>
                            </div>

                            <div class="d-flex justify-content-between">
                                <a href="/profile" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</a>
                                <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                            </div>
                        </form>
                    </div>

                    <div class="col-md-6">
                        <h5>–ê–≤–∞—Ç–∞—Ä</h5>

                        <div class="text-center mb-3">
                            {% if user.avatar_url and user.avatar_url != 'default_avatar.png' %}
                                <img src="/static/uploads/{{ user.avatar_url }}"
                            {% else %}
                                <img src="/static/default_avatar.png"
                            {% endif %}
                                 class="rounded-circle mb-3"
                                 width="150" height="150"
                                 alt="{{ user.username }}"
                                 onerror="this.src='/static/default_avatar.png'">
                            <p class="text-muted">–¢–µ–∫—É—â–∏–π –∞–≤–∞—Ç–∞—Ä</p>
                        </div>

                        <form method="post" action="/profile/upload-avatar" enctype="multipart/form-data">
                            <div class="mb-3">
                                <label for="avatar" class="form-label">–ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–π –∞–≤–∞—Ç–∞—Ä</label>
                                <input type="file" class="form-control" id="avatar" name="file"
                                       accept=".png,.jpg,.jpeg,.gif" required>
                                <small class="text-muted">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 5MB. –†–∞–∑—Ä–µ—à–µ–Ω—ã: PNG, JPG, JPEG, GIF</small>
                            </div>
                            <button type="submit" class="btn btn-outline-primary w-100">
                                üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤–∞—Ç–∞—Ä
                            </button>
                        </form>

                        {% if user.avatar_url and user.avatar_url != 'default_avatar.png' %}
                        <div class="mt-3">
                            <form method="post" action="/profile/remove-avatar" onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å –∞–≤–∞—Ç–∞—Ä?')">
                                <button type="submit" class="btn btn-outline-danger w-100">
                                    üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –∞–≤–∞—Ç–∞—Ä
                                </button>
                            </form>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}